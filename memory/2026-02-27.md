# 2026-02-27 (KST) — Davinci log

## Context
- Task: Stabilize Claude Code + davinci-framework `/da:*` workflow to reliably create file artifacts, then build a Tetris web game (Next.js + TS + Canvas) in `~/Desktop/work/tetris-next`.
- Requirement: continuous git commit + push to `andrewkim-gif` repos, and periodic progress reports.

## What happened (timeline-ish)
- Created/used project: `~/Desktop/work/tetris-next`.
- `/da:idea` + `/da:plan` completed; PLAN committed as `c9a7512`.
- `/da:system` repeatedly failed to produce expected ADR files; observed Claude Code banner: "plugin(s) failed to install".
- Investigated Claude Code plugin system:
  - Found enabledPlugins referenced multiple DA plugin IDs (path-based) that were not installable.
  - Noted marketplace config in `~/.claude/plugins/known_marketplaces.json` and `installed_plugins.json`.
  - Debug logs showed missing/uninstallable plugins and marketplace schema errors.
- Actions taken to reduce plugin failures / stabilize:
  - Removed stale path-based DA plugin reference from `~/.claude/settings.json`.
  - Removed `and@andrew-marketplace` from enabledPlugins and pruned marketplace/installed entries.
  - Reset local `davinci-framework` repo to a clean `origin/main` state.
  - Added local marketplace file for davinci plugin: `davinci-plugin/.claude-plugin/marketplace.json` and adjusted settings to use `da@davinci-framework` rather than `da@<path>`.
- Monitoring/reporting adjustments:
  - Set up OpenClaw cron job for progress reporting; initially every 1m (`da-1m-check`), then changed to every 5m (`da-5m-check`).
  - Discovered cron-based monitoring often reported "idle" because it couldn’t reliably attach to interactive Claude Code TTY sessions; filesystem evidence was more reliable.
- GitHub:
  - Created repo `https://github.com/andrewkim-gif/tetris-next`, set `origin`, and pushed local commits.
  - Added `.gitignore` for `.DS_Store` and committed (`4b061df`).
- Late progress:
  - Confirmed `docs/adr` eventually contained newly created ADR files (ADR-004..ADR-007), but the gate target ADR-001/ADR-002 were still missing at the moment of stop.

## Key issues / lessons
1) **Claude Code plugin installability depends on a valid marketplace.json**
   - Path-based plugin IDs (`da@/Users/.../davinci-plugin`) can become "uninstallable" if the marketplace isn’t configured or schema is invalid.
   - Using a named marketplace (`davinci-framework`) + `da@davinci-framework` is more stable.

2) **Cron monitoring ≠ interactive session monitoring**
   - OpenClaw cron jobs can’t always observe live Claude Code step output; they can still monitor by checking filesystem artifacts (expected files, git changes) and Claude debug logs.

3) **Avoid 'idle spam'; always propose next action**
   - When no task is running, the correct behavior is to (a) restart the correct session, (b) re-issue the next `/da:*` command, or (c) check the artifact gate, not just report idle.

4) **Keep the gate crisp**
   - If the gate is "ADR-001/ADR-002 must exist", enforce those exact filenames and verify with `ls -la docs/adr`.

## Next step after stop
- Resume at `~/Desktop/work/tetris-next`:
  1) Re-run `/da:system` with strict instruction to create/overwrite ADR-001 + ADR-002.
  2) Verify via `ls -la docs/adr`.
  3) Commit + push.
  4) Proceed to `/da:design` → `/da:dev` to actually implement the Tetris game.
